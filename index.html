<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Katherine & Ricardo</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ICONO DE MUSICA -->
<div id="music-icon">
  <img src="play.png" alt="Reproducir m煤sica" id="music-img">
</div>
<audio id="music" loop>
  <source src="musica.mp3" type="audio/mp3">
</audio>

<!-- HERO -->
<section class="hero">

    <img src="foto-fondo.jpg" class="hero-img">

  <div class="hero-content">

    <h3 class="subtitle">Nuestra boda</h3>
    <h1>Katherine & Ricardo</h1>

    <!-- CUENTA REGRESIVA CIRCULAR -->
    <div id="countdown" class="countdown">
      <div class="circle"><span id="days">0</span><small>D铆as</small></div>
      <div class="circle"><span id="hours">0</span><small>Horas</small></div>
      <div class="circle"><span id="minutes">0</span><small>Minutos</small></div>
      <div class="circle"><span id="seconds">0</span><small>Segundos</small></div>
    </div>

<!-- fecha-->
<div class="date-container">
  <img src="linea.png" alt="linea" class="linea">
 <p class="date-below">15.05.2027</p>
  <img src="linea.png" alt="linea" class="linea">
</div>

   
  </div>
</section>

<!-- -->

<!-- HISTORIA -->
<section class="section historia">
  <h2>Nuestra historia</h2>
  <p>Katherine y Ricardo se conocieron en 2020 y desde entonces comenzaron esta hermosa aventura juntos. Te invitamos a celebrar con nosotros nuestro gran d铆a.</p>
</section>

<!-- EVENTO -->
<section class="section evento">
  <h2>Evento</h2>
  <p>Ceremonia: 15:00 hrs</p>
  <p>Recepci贸n: 17:00 hrs</p>
  <p>Lugar: Braga, Portugal</p>
</section>



<script src="script.js"></script>



<div id="mensajeConfirmado" class="mensaje-confirmado" style="display:none;">
 Invitaci贸n confirmada<br>
Si necesitas hacer cambios por favor contactar a los Novios.
</div>
<form id="rsvpForm">

<input type="hidden" id="codigo">

<label>Nombre</label>
<input type="text" id="nombre">

<label>Adultos</label>
<input type="number" id="adultos" min="0">

<label>Ni帽os</label>
<input type="number" id="ninos" min="0">

<label>Alergias</label>
<input type="text" id="alergias">

<label>Comentarios</label>
<textarea id="comentarios"></textarea>

<button type="submit">Confirmar</button>

</form>


<script>

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyJtGe3cAjUEraZnZbA6RF9qX5phKgt781hXnhdJvfR1lyntGSs_G6IevgK0YHIE8F_tw/exec";

document.getElementById("rsvpForm").addEventListener("submit", async function(e){

e.preventDefault();

const data = {

codigo: document.getElementById("codigo").value,

nombre: document.getElementById("nombre").value,

adultos: document.getElementById("adultos").value,

ninos: document.getElementById("ninos").value,

alergias: document.getElementById("alergias").value,

comentarios: document.getElementById("comentarios").value

};

try {

await fetch(SCRIPT_URL, {

method: "POST",

mode: "no-cors",

headers: {

"Content-Type": "application/json"

},

body: JSON.stringify(data)

});

if(data.adultos == 0){

alert("Has cancelado tu invitaci贸n");

}else{

alert("Confirmaci贸n enviada correctamente");

}

} catch(error){

alert("Error al enviar");

}

});

</script>

<script>

document.addEventListener("DOMContentLoaded", function(){

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby0OcB1JLBoB83cZAG9P8kIbIDyCJ__MqmJrei1OCY4_Zbtp9wa1g6nwg29qX2WSraU/exec";

const params = new URLSearchParams(window.location.search);

const codigo = params.get("codigo");


// VALIDAR CODIGO

if(!codigo){

alert("Invitaci贸n no v谩lida");

return;

}


// PEDIR DATOS

fetch(SCRIPT_URL + "?codigo=" + codigo)

.then(response => response.json())

.then(data => {

console.log(data);


// LLENAR FORMULARIO

document.getElementById("codigo").value = codigo;

document.getElementById("nombre").value = data.nombre;


// LIMITAR ADULTOS

const adultosInput = document.getElementById("adultos");

adultosInput.max = data.adultos;

adultosInput.value = data.adultos;


// NIOS

const ninosInput = document.getElementById("ninos");

if(data.ninosPermitidos == 0){

ninosInput.value = 0;

ninosInput.disabled = true;

ninosInput.placeholder = "Ni帽os no permitidos";

}else{

ninosInput.max = data.ninos;

ninosInput.value = data.ninos;

}




// SI YA CONFIRM 

if(data.confirmado == "SI"){


// mostrar mensaje

document.getElementById("mensajeConfirmado").style.display = "block";


// bloquear formulario

document.getElementById("rsvpForm").classList.add("form-bloqueado");

}


// SI HACEN CLICK

document.getElementById("rsvpForm").addEventListener("click", function(){

if(this.classList.contains("form-bloqueado")){

alert("Esta invitaci贸n ya fue confirmada");

}

});


})

.catch(error => {

console.error(error);

alert("Error conectando con invitados");

});


});

</script>

</body>



</html>

